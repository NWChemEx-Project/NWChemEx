

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Building the NWChemEx Package &mdash; NWChemEx 1.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="&lt;no title&gt;" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> NWChemEx
          

          
          </a>

          
            
            
              <div class="version">
                1.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Building the NWChemEx Package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#prerequisites">Prerequisites</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#blas-lapack-scalapack">BLAS/LAPACK/ScaLAPACK</a></li>
<li class="toctree-l3"><a class="reference internal" href="#libint2">libint2</a></li>
<li class="toctree-l3"><a class="reference internal" href="#github-personal-access-token">GitHub Personal Access Token</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#building-nwchemex">Building NWChemEx</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#cmake-toolchain-file">CMake Toolchain File</a></li>
<li class="toctree-l3"><a class="reference internal" href="#nwchemex-build-script">NWChemEx Build Script</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://nwchemex-project.github.io/NWChemEx/nwchemex_cxx_api/index.html">C++ API</a></li>
</ul>
<p class="caption"><span class="caption-text">Core NWX Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://nwchemex-project.github.io/SDE/">SDE</a></li>
<li class="toctree-l1"><a class="reference external" href="https://nwchemex-project.github.io/PropertyTypes/">Property Types</a></li>
<li class="toctree-l1"><a class="reference external" href="https://nwchemex-project.github.io/Utilities/">Utilities</a></li>
<li class="toctree-l1"><a class="reference external" href="https://nwchemex-project.github.io/LibChemist/">LibChemist</a></li>
<li class="toctree-l1"><a class="reference external" href="https://nwchemex-project.github.io/DeveloperTools/">Developer Docs</a></li>
</ul>
<p class="caption"><span class="caption-text">First Party NWX Supermodules</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://nwchemex-project.github.io/Integrals/">Integrals</a></li>
<li class="toctree-l1"><a class="reference external" href="https://nwchemex-project.github.io/SCF/">SCF</a></li>
<li class="toctree-l1"><a class="reference external" href="https://nwchemex-project.github.io/MP2/">MP2</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">NWChemEx</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">&lt;no title&gt;</a> &raquo;</li>
        
      <li>Building the NWChemEx Package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/installation/building.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="building-the-nwchemex-package">
<h1>Building the NWChemEx Package<a class="headerlink" href="#building-the-nwchemex-package" title="Permalink to this headline">¶</a></h1>
<section id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h2>
<p>To compile NWChemEx, some packages must be available on your system beforehand:</p>
<ol class="arabic simple">
<li><p>A C++ compiler supporting the C++17 standard</p></li>
<li><p>CMake</p></li>
<li><p>BLAS/LAPACK/ScaLAPACK</p></li>
<li><p>Boost</p></li>
<li><p>MPI</p></li>
<li><p>libint2</p></li>
</ol>
<p>If necessary, more installation details for a package will be provided in the
subsections below.</p>
<p>NWChemEx also depends on a number of repositories listed below. Please visit the
repositories and ensure that any additional packages that must be available
before building are installed.</p>
<ol class="arabic simple">
<li><p>integrals &lt;<a class="reference external" href="https://github.com/NWChemEx-Project/Integrals">https://github.com/NWChemEx-Project/Integrals</a>&gt;</p></li>
<li><p>SCF &lt;<a class="reference external" href="https://github.com/NWChemEx-Project/SCF">https://github.com/NWChemEx-Project/SCF</a>&gt;</p></li>
<li><p>MP2 &lt;<a class="reference external" href="https://github.com/NWChemEx-Project/MP2">https://github.com/NWChemEx-Project/MP2</a>&gt;</p></li>
</ol>
<section id="blas-lapack-scalapack">
<h3>BLAS/LAPACK/ScaLAPACK<a class="headerlink" href="#blas-lapack-scalapack" title="Permalink to this headline">¶</a></h3>
<p><strong>Intel MKL (Intel oneAPI MKL):</strong> Ensure that all required environment variables
for the Intel MKL are set by executing <code class="docutils literal notranslate"><span class="pre">/path/to/intel/mkl/bin/mklvars.sh</span> <span class="pre">&lt;arch&gt;</span></code>,
where <code class="docutils literal notranslate"><span class="pre">&lt;arch&gt;</span></code> must be either <code class="docutils literal notranslate"><span class="pre">ia32</span></code> or <code class="docutils literal notranslate"><span class="pre">intel64</span></code>. The following command
can be added to your <code class="docutils literal notranslate"><span class="pre">.bashrc</span></code> to set the required environment variables
automatically for all new terminal sessions:</p>
<p><strong>Other BLAS/LAPACK/ScaLAPACK:</strong> If not using the Intel MKL, closely study the
BLAS/LAPACK section of the NWChemEx <code class="docutils literal notranslate"><span class="pre">toolchain.cmake</span></code> file below to ensure all
paths are correct for your BLAS/LAPACK/ScaLAPACK installations.</p>
</section>
<section id="libint2">
<h3>libint2<a class="headerlink" href="#libint2" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Important:</strong> Boost must be installed and in your path prior to building
libint2. This is not required by libint2, as libint2 will use its own
internal build of Boost. However, when building NWChemEx, errors related
to using this internal build of Boost have been observed (by Zach Crandall
as of April 29, 2021).</p>
</div>
<p>The libint2 build will take a long time (probably &gt;2 hrs), and should be started
well in advance. At the time of writing, libint v2.6.0 can be obtained from the
<a class="reference external" href="https://github.com/evaleev/libint/releases/tag/v2.6.0">libint v2.6.0 release</a>
page and built using instructions at
<a class="reference external" href="https://github.com/evaleev/libint/wiki">libint Wiki</a> if a custom library is
needed.</p>
<p>The following build script can be used to build and install the libint2
pre-generated library “lmax=6 library (standard ints only)”, which can be
downloaded from the
<a class="reference external" href="https://github.com/evaleev/libint/releases/tag/v2.6.0">libint v2.6.0 release</a>
page or directly from
<a class="reference external" href="https://github.com/evaleev/libint/releases/download/v2.6.0/libint-2.6.0.tgz">here</a>.
Download and extract the pre-generated libint v2.6.0 library. Inside the newly
extracted libint-2.6.0 directory, create a file named <code class="docutils literal notranslate"><span class="pre">build.sh</span></code> and paste the
below contents, modifying everything in angled brackets (&lt;&gt;) to be correct for
your system.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env bash</span>

cmake -S . <span class="se">\</span>
      -B build <span class="se">\</span>
      -DCMAKE_INSTALL_PREFIX<span class="o">=</span>&lt;desired_install_location&gt; <span class="se">\</span>
      -DCMAKE_CXX_COMPILER<span class="o">=</span>&lt;c++_compiler&gt; <span class="se">\</span>
      -DCMAKE_CXX_FLAGS<span class="o">=</span><span class="s2">&quot;-O3&quot;</span> <span class="se">\</span>
      -DCMAKE_CXX_STANDARD<span class="o">=</span><span class="m">11</span> <span class="se">\</span>
      -DCMAKE_POSITION_INDEPENDENT_CODE<span class="o">=</span>TRUE <span class="se">\</span>
      <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="p">|</span> tee OUTPUT.GEN

cmake --build build --target install <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="p">|</span> tee OUTPUT.BUILD
</pre></div>
</div>
</section>
<section id="github-personal-access-token">
<h3>GitHub Personal Access Token<a class="headerlink" href="#github-personal-access-token" title="Permalink to this headline">¶</a></h3>
<p>A GitHub Personal Access Token (PAT) is necessary since, at the moment, NWChemEx
and some dependencies are hosted in private repositories. To create a PAT,
follow the instructions at GitHub’s <a class="reference external" href="https://docs.github.com/en/github/authenticating-to-github/creating-a-personal-access-token">Creating a personal access token</a>
page. This PAT will be used when prompted for a password while cloning repositories.</p>
</section>
</section>
<section id="building-nwchemex">
<h2>Building NWChemEx<a class="headerlink" href="#building-nwchemex" title="Permalink to this headline">¶</a></h2>
<p>The build instructions are given in the following sections based on a few
assumptions:</p>
<ol class="arabic simple">
<li><p>You are using a sane Unix-like operating system.</p></li>
<li><p>All components will be installed in the same location.</p></li>
</ol>
<p>The following two files will be created to build NWChemEx, with instructions for
each in the sections below:</p>
<ol class="arabic simple">
<li><p>CMake Toolchain File: <code class="docutils literal notranslate"><span class="pre">toolchain.cmake</span></code></p></li>
<li><p>NWChemEx Build Script: <code class="docutils literal notranslate"><span class="pre">build_nwx.sh</span></code></p></li>
</ol>
<section id="cmake-toolchain-file">
<h3>CMake Toolchain File<a class="headerlink" href="#cmake-toolchain-file" title="Permalink to this headline">¶</a></h3>
<p>NWChemEx requires knowledge of many packages and tools which may have system-
specific installation locations. Inside the top level directory where NWChemEx
will be built, create a toolchain file named <code class="docutils literal notranslate"><span class="pre">toolchain.cmake</span></code>. This file
should contain the following information, replacing everything in angled
brackets (&lt;&gt;) for your system.</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="c"># Compilers</span>
<span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_C_COMPILER</span>   <span class="s">&lt;C</span> <span class="s">compiler&gt;</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_CXX_COMPILER</span> <span class="s">&lt;C++</span> <span class="s">compiler&gt;</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">MPI_C_COMPILER</span>     <span class="s">&lt;MPI</span> <span class="s">C</span> <span class="s">compiler&gt;</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">MPI_CXX_COMPILER</span>   <span class="s">&lt;MPI</span> <span class="s">CXX</span> <span class="s">compiler&gt;</span><span class="p">)</span>

<span class="c"># Token for private repos</span>
<span class="nb">set</span><span class="p">(</span><span class="s">CPP_GITHUB_TOKEN</span> <span class="s">&lt;your_super_secret_github_PAT&gt;</span><span class="p">)</span>

<span class="c"># Options</span>
<span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_POSITION_INDEPENDENT_CODE</span> <span class="s">TRUE</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">BUILD_SHARED_LIBS</span> <span class="s">TRUE</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">BUILD_TESTING</span> <span class="s">TRUE</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_PREFIX_PATH</span> <span class="s">&lt;prefix_directory&gt;</span><span class="p">)</span> <span class="c"># This is where libint2 is installed</span>
<span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_CXX_STANDARD</span> <span class="s">17</span><span class="p">)</span>

<span class="c"># BLAS/LAPACK</span>
<span class="nb">set</span><span class="p">(</span><span class="s">ENABLE_SCALAPACK</span> <span class="s">ON</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">MKLROOT</span> <span class="o">$ENV{</span><span class="nv">MKLROOT</span><span class="o">}</span><span class="p">)</span> <span class="c"># Environment variable set through your MKL install or a script</span>
<span class="nb">set</span><span class="p">(</span><span class="s">LAPACK_LIBRARIES</span> <span class="s2">&quot;-L${MKLROOT}/lib/intel64 -Wl,--no-as-needed -lmkl_intel_lp64 -lmkl_sequential -lmkl_core -lpthread -lm -ldl&quot;</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">LAPACK_INCLUDE_DIRS</span> <span class="s2">&quot;${MKLROOT}/include&quot;</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">lapack_LIBRARIES</span> <span class="o">${</span><span class="nv">LAPACK_LIBRARIES</span><span class="o">}</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">SCALAPACK_LIBRARIES</span>  <span class="s">-L</span><span class="o">${</span><span class="nv">MKLROOT</span><span class="o">}</span><span class="s">/lib/intel64</span> <span class="s">-Wl,--no-as-needed</span> <span class="s">-lmkl_scalapack_lp64</span> <span class="s">-lmkl_intel_lp64</span> <span class="s">-lmkl_sequential</span> <span class="s">-lmkl_core</span> <span class="s">-lmkl_blacs_openmpi_lp64</span> <span class="s">-lpthread</span> <span class="s">-lm</span> <span class="s">-ldl</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">blacs_LIBRARIES</span> <span class="o">${</span><span class="nv">SCALAPACK_LIBRARIES</span><span class="o">}</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">scalapack_LIBRARIES</span> <span class="o">${</span><span class="nv">SCALAPACK_LIBRARIES</span><span class="o">}</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">lapack_LIBRARIES</span> <span class="o">${</span><span class="nv">LAPACK_LIBRARIES</span><span class="o">}</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_CXX_FLAGS</span> <span class="s2">&quot;${CMAKE_CXX_FLAGS} -DOMPI_SKIP_MPICXX&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="nwchemex-build-script">
<h3>NWChemEx Build Script<a class="headerlink" href="#nwchemex-build-script" title="Permalink to this headline">¶</a></h3>
<p>Create a new file named <code class="docutils literal notranslate"><span class="pre">build_nwx.sh</span></code> next to <code class="docutils literal notranslate"><span class="pre">toolchain.cmake</span></code> and paste
the script below into it. This script will download, build, and install NWChemEx
and any remaining dependencies. Logs for the build will be generated beside this
build script.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Clone the repo</span>
git clone https://github.com/NWChemEx-Project/NWChemEx.git <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="p">|</span> tee <span class="s2">&quot;OUTPUT.GITCLONE&quot;</span>
<span class="c1"># &lt;Type login information if prompted.&gt;</span>

<span class="c1"># Navigate into the newly created NWChemEx subdirectory</span>
<span class="nb">cd</span> NWChemEx

<span class="c1"># Generate project buildsystem</span>
cmake -H. <span class="se">\</span>
      -Bbuild <span class="se">\</span>
      -DCMAKE_TOOLCHAIN_FILE<span class="o">=</span><span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>/../toolchain.cmake <span class="se">\</span>
      -DCMAKE_BUILD_TYPE<span class="o">=</span>Release <span class="se">\</span>
     <span class="c1">#-DCMAKE_INSTALL_PREFIX=&lt;where/you/want/to/install&gt; # cannot install right now</span>
      <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="p">|</span> tee <span class="s2">&quot;../OUTPUT.GEN&quot;</span>

<span class="c1"># Build the project</span>
cmake --build build <span class="se">\</span>
     <span class="c1">#--target install \ # we cannot actually install yet</span>
      <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="p">|</span> tee <span class="s2">&quot;../OUTPUT.BUILD&quot;</span>

<span class="c1"># Run tests</span>
<span class="nb">cd</span> build <span class="o">&amp;&amp;</span> ctest <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="p">|</span> tee <span class="s2">&quot;../../OUTPUT.TEST&quot;</span>

<span class="c1"># Return to the top level directory</span>
<span class="nb">cd</span> ../..
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For finer-grained control over the build, we direct the reader to the more
thorough CMaize build instructions located <a class="reference external" href="https://cmakepackagingproject.readthedocs.io/en/latest/?badge=latest">here</a>
and note that NWChemEx depends on several other projects:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/catchorg/Catch2">Catch2</a> (for testing only)</p></li>
</ul>
</div>
</section>
</section>
</section>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="index.html" class="btn btn-neutral float-left" title="&lt;no title&gt;" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, NWChemEx Team.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>